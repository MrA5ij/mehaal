<% 
  var title = 'Manage Projects';
  var page = 'projects';
%>
<%- include('../layout', { title, page, user, body: `
  <h1>Manage Projects</h1>
  <%- include('../partials/card', { title: null, body: `
    <%- include('../partials/button', { label: 'Add New Project', type: 'button', extraClass: '', attrs: 'id="showAddProjectBtn"' }) %>
    <div id="addForm" style="display: none; margin-top: 2rem;">
      <h3>Add New Project</h3>
      <form method="POST" action="/api/projects" id="projectForm">
        <%- include('../partials/form-group', { id: 'slug', label: 'Slug (URL-friendly)', name: 'slug', type: 'text', required: true }) %>
        <%- include('../partials/form-group', { id: 'title', label: 'Title', name: 'title', type: 'text', required: true }) %>
        <%- include('../partials/form-group', { id: 'tagline', label: 'Tagline', name: 'tagline', type: 'text', required: true }) %>
        <div class="form-group">
          <label for="description">Description</label>
          <textarea id="description" name="description" required></textarea>
        </div>
        <div class="form-group">
          <label for="impact_statement">Impact Statement</label>
          <textarea id="impact_statement" name="impact_statement" required></textarea>
        </div>
        <%- include('../partials/form-group', { id: 'display_order', label: 'Display Order', name: 'display_order', type: 'number', required: false, value: 0 }) %>
        <div class="form-group">
          <label for="features">Features (one per line)</label>
          <textarea id="features" name="features" placeholder="Feature 1\nFeature 2\nFeature 3"></textarea>
        </div>
        <%- include('../partials/button', { label: 'Save Project', type: 'submit' }) %>
        <%- include('../partials/button', { label: 'Cancel', type: 'button', extraClass: 'btn-secondary', attrs: 'id="cancelAddProjectBtn"' }) %>
      </form>
    </div>
  ` }) %>
  <%- include('../partials/card', { title: 'Existing Projects', body: `
    <table>
      <thead>
        <tr>
          <th>Title</th>
          <th>Slug</th>
          <th>Order</th>
          <th>Features</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        ${projects.map(p => `
          <tr>
            <td><strong>${p.title}</strong><br><small class='text-muted'>${p.tagline}</small></td>
            <td>${p.slug}</td>
            <td>${p.display_order}</td>
            <td><a href="/admin/projects/${p.id}/features" class="btn btn-secondary">Manage Features</a></td>
            <td>
              <a href="/admin/projects/${p.id}/edit" class="btn btn-secondary">Edit</a>
            </td>
          </tr>
        `).join('')}
      </tbody>
    </table>
  ` }) %>
` }) %>
